This version taken from the Python code in Tyler Neylon's SODA 2010 paper, with hints from his iPhone/iPad app.
